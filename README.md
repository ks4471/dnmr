
# Enrichment test for gene set over-representation for de-novo mutations associated with neurodevelopmental disorders based on denovo-db database

input_gene_sets=list(gene_set1=c(hgnc_gene_ids),gene_set_2=c(hgnc_gene_ids))
str(input_gene_sets)
List of 52
 $ AMY.1       : chr [1:593] "ABCA4" "ABCG4" "ACOT7" "ACSM4" ...
 $ AMY.2       : chr [1:590] "A2ML1" "ABCC11" "ABCC9" "ABHD5" ...
 $ AMY.3       : chr [1:518] "ABCB4" "ABI3" "ACPP" "ACTL6A" ...
 $ AMY.4       : chr [1:507] "AAMP" "AAR2" "AARS" "ABCF1" ...
 $ AMY.5       : chr [1:502] "ABCA3" "ABCF2" "ABL2" "ACAD10" ...
 $ AMY.6       : chr [1:499] "A1BG" "AIP" "AK1" "ALKBH3" ...
 $ AMY.7       : chr [1:494] "ABCC1" "ACTN4" "ADAMTS18" "ADGRD2" ...
 $ AMY.8       : chr [1:487] "AAK1" "ABCA5" "ABCC8" "ACSL4" ...
 $ AMY.9       : chr [1:486] "AASDHPPT" "ABCE1" "ABHD13" "ABRAXAS2" ...
 $ AMY.10      : chr [1:472] "ABHD18" "ACVR2B" "ADAM17" "ADCY6" ...
 $ AMY.11      : chr [1:468] "AARSD1" "ABCB8" "ABCB9" "ABCD4" ...
 $ AMY.12      : chr [1:458] "ABLIM2" "ACOT8" "ACTR1B" "ACTR3B" ...
 $ AMY.13      : chr [1:444] "AAGAB" "ACBD4" "ACOT13" "ACP1" ...

dnm_enrich=dnmr(input_gene_sets)

# wrapper for heatmap.2 function, values='pval' converts P-values of enrichment to -log10(Pvalue) & adds R style significance values e.g. *** <0.0001
Heat(as.matrix(dnm_enrich$pval),values='pval')

# data from denovo-db:
Turner, T. N. et al. denovo-db: a compendium of human de novo variants. Nucleic Acids Res. 45, D804–D811 (2017).

# test used in:
1.  Delahaye-Duriez, A. et al. Rare and common epilepsies converge on a shared gene regulatory network providing opportunities for novel antiepileptic drug discovery. Genome Biol. 17, 245 (2016).
2.  Johnson, M. R. et al. Systems genetics identifies a convergent gene network for cognition and neurodevelopmental disease. Nat. Neurosci. 19, 223–232 (2015).



